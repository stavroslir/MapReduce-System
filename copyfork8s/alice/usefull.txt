Deploy Alice:

kubectl apply -f alice.yaml


Exec in the pod(to test):
kubectl exec -it alice -- /bin/sh

Curl command example:

login as admin:
    curl -X POST -H "Content-Type: application/json" -d '{"username":"admin", "password":"adminpassword"}' http://ui-service:80/login

Create a user:
    curl -X POST http://ui-service:80/register -H "Content-Type: application/json" -H "x-access-tokens: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsInJvbGUiOiJhZG1pbiIsImVtYWlsIjoiYWRtaW5AZXhhbXBsZS5jb20iLCJpYXQiOjE2ODg2MzYxMDIsImV4cCI6MTY4ODYzNzkwMn0.vBs_AdXJ1Nd5xkoCVtWezrl5mJyetozCZk904FW6R0s" -d '{"username": "new_user", "password": "new_password", "email": "new_user@example.com", "role": "user"}'

Login as the new user: 
    curl -X POST http://ui-service:80/login -H "Content-Type: application/json" -d '{"username": "new_user", "password": "new_password"}'

View jobs:
    curl -X GET http://ui-service:80/view_jobs -H "Content-Type: application/json" -H "x-access-tokens: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJuZXdfdXNlciIsInJvbGUiOiJ1c2VyIiwiZW1haWwiOiJuZXdfdXNlckBleGFtcGxlLmNvbSIsImlhdCI6MTY4ODYzODQ4NCwiZXhwIjoxNjg4NjQwMjg0fQ.KrA0xL2e9EEorLawDK579lXHLhgmHMQkSgJgql8MaV0" 

Register Worker:
    curl -X POST -H "Content-Type: application/json" -H "x-access-tokens: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsInJvbGUiOiJhZG1pbiIsImVtYWlsIjoiYWRtaW5AZXhhbXBsZS5jb20iLCJpYXQiOjE2ODg2Mzk0NTIsImV4cCI6MTY4ODY0MTI1Mn0.wKFg1yIgl1cXh3sFnwhT91Fy8vU1YffE55Lg370P9zI" -d '{
    "address": "10.1.0.81:80"
}' http://ui-service:80/register_worker


    curl -X POST -H "Content-Type: application/json" -H "x-access-tokens: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsInJvbGUiOiJhZG1pbiIsImVtYWlsIjoiYWRtaW5AZXhhbXBsZS5jb20iLCJpYXQiOjE2ODg2Mzk0NTIsImV4cCI6MTY4ODY0MTI1Mn0.wKFg1yIgl1cXh3sFnwhT91Fy8vU1YffE55Lg370P9zI" -d '{
    "address": "worker-service.default.svc.cluster.local"
}' http://ui-service:80/register_worker

View workers:
    curl -X GET http://ui-service:80/view_workers -H "Content-Type: application/json" -H "x-access-tokens: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsInJvbGUiOiJhZG1pbiIsImVtYWlsIjoiYWRtaW5AZXhhbXBsZS5jb20iLCJpYXQiOjE2ODg2Mzk0NTIsImV4cCI6MTY4ODY0MTI1Mn0.wKFg1yIgl1cXh3sFnwhT91Fy8vU1YffE55Lg370P9zI" 



Submit a job as a new user:
curl -X POST \
        -H "Content-Type: application/json" \
        -H "x-access-tokens: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsInJvbGUiOiJhZG1pbiIsImVtYWlsIjoiYWRtaW5AZXhhbXBsZS5jb20iLCJpYXQiOjE2ODg2Mzk0NTIsImV4cCI6MTY4ODY0MTI1Mn0.wKFg1yIgl1cXh3sFnwhT91Fy8vU1YffE55Lg370P9zI" \
        -d '{
            "user_id": "1", 
            "task_type": "MAP", 
            "function_file": "'"$(base64 -i functions.py)"'", 
            "job_description": "Test job", 
            "input_path": "/app/storage/test", 
            "output_path": "/app/storage/output", 
            "function_name": "map_function"
        }' \
        http://ui-service:80/submit_job



curl -X POST http://monitor-service/register


curl -X POST -H "Content-Type: application/json" -d '{ "user_id": "1", "function_file": "/app/shared/functions.py", "job_description": "Test job", "input_path": "/app/shared/test"}' http://monitor-service/job
